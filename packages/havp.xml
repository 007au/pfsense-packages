<packagegui>
	<name>havp</name>
	<version>0.3</version>
	<title>Havp: Settings</title>
	<include_file>/usr/local/pkg/havp.inc</include_file>
        <aftersaveredirect>/pkg_edit.php?xml=havp.xml&amp;id=0</aftersaveredirect>
	<menu>
		<name>HAVP</name>
		<section>Services</section>
		<tooltiptext>Modify HAVP settings.</tooltiptext>
		<url>/pkg_edit.php?xml=havp.xml&amp;id=0</url>
		<configfile>havp.xml</configfile>
	</menu>

	<service>
		<name>havp</name>
		<rcfile>/usr/local/etc/rc.d/havp.sh</rcfile>
		<description>HTTP Anti Virus Proxy.</description>
	</service>

	<tabs>
		<tab>
			<text>Settings</text>
			<url>/pkg_edit.php?xml=havp.xml&amp;id=0</url>
			<active/>
		</tab>
		<tab>
			<text>Whitelist</text>
			<url>/pkg.php?xml=havp_whitelist.xml</url>
		</tab>
		<tab>
			<text>Blacklist</text>
			<url>/pkg.php?xml=havp_blacklist.xml</url>
		</tab>
		<tab>
			<text>Exclude from Transparent Proxy</text>
			<url>/pkg.php?xml=havp_trans_exclude.xml</url>
		</tab>
	</tabs>

    	<additional_files_needed>
	    <prefix>/usr/local/pkg/</prefix>
	    <chmod>0755</chmod>
	    <item>http://agni.linuxense.com/packages/config/havp.inc</item>
	</additional_files_needed>
    	<additional_files_needed>
	    <prefix>/usr/local/pkg/</prefix>
	    <chmod>0755</chmod>
	    <item>http://agni.linuxense.com/packages/config/havp_whitelist.xml</item>
	</additional_files_needed>
    	<additional_files_needed>
	    <prefix>/usr/local/pkg/</prefix>
	    <chmod>0755</chmod>
	    <item>http://agni.linuxense.com/packages/config/havp_blacklist.xml</item>
	</additional_files_needed>
    	<additional_files_needed>
	    <prefix>/usr/local/pkg/</prefix>
	    <chmod>0755</chmod>
	    <item>http://agni.linuxense.com/packages/config/havp_startup.inc</item>
	</additional_files_needed>
    	<additional_files_needed>
	    <prefix>/usr/local/pkg/</prefix>
	    <chmod>0755</chmod>
	    <item>http://agni.linuxense.com/packages/config/havp_trans_exclude.xml</item>
	</additional_files_needed>
    	<additional_files_needed>
	    <prefix>/usr/local/pkg/</prefix>
	    <chmod>0755</chmod>
	    <item>http://agni.linuxense.com/packages/config/havp.sh</item>
	</additional_files_needed>

	<configpath>['installedpackages']['havp]['config']</configpath>

	<fields>
		<field>
			<fielddescr>Server Number</fielddescr>
			<fieldname>servernumber</fieldname>
			<description>Specify how many servers (child processes) are simultaneously listening on port PORT for a connection. Minimum value should be the peak requests-per-second expected + 5 for headroom.</description>
			<type>input</type>
			<default_value>10</default_value>
		</field>		
		<field>
			<fielddescr>Max Server Number</fielddescr>
			<fieldname>maxservers</fieldname>
			<description>This is the hard limit for concurrent requests processed.</description>
			<type>input</type>
			<default_value>100</default_value>
		</field>		
		<field>
			<fielddescr>Transparent?</fielddescr>
			<fieldname>transparent</fieldname>
			<description>Run HAVP as transparent Proxy? [Bind Address will be disregarded in this mode, HAVP will listen on localhost] </description>
			<type>checkbox</type>
		</field>		
		<field>
			<fielddescr>Port</fielddescr>
			<fieldname>port</fieldname>
			<description>Port HAVP is listening on.</description>
			<type>input</type>
			<default_value>8080</default_value>
		</field>		
		<field>
			<fielddescr>Bind Address</fielddescr>
			<fieldname>bind_address</fieldname>
			<description>IP address that HAVP listens on. Leave it empty to bind all addresses, defaults to LAN address</description>
			<type>interfaces_selection</type>
			<default_value>lan</default_value>
		</field>		
		<field>
			<fielddescr>Source Address</fielddescr>
			<fieldname>source_address</fieldname>
			<description>IP address used for sending outbound packets. Let it be undefined if you want OS to handle right address.</description>
			<type>input</type>
		</field>		
		<field>
			<fielddescr>Range Requests</fielddescr>
			<fieldname>range</fieldname>
			<description> Allow HTTP Range Requests?</description>
			<type>checkbox</type>
			<default_value>on</default_value>
		</field>		
		<field>
			<fielddescr>Log All Requests?</fielddescr>
			<fieldname>log_oks</fieldname>
			<description>Log Details: true: Log all Requests, false: log only virus hits</description>
			<type>checkbox</type>
			<default_value>on</default_value>
		</field>		
		<field>
			<fielddescr>Virus Database Reload Time.</fielddescr>
			<fieldname>dbreload</fieldname>
			<description>Specify here the number of minutes to wait for reloading. Default 60 Minutes.</description>
			<type>input</type>
			<default_value>60</default_value>
		</field>		
		<field>
			<fielddescr>Parent Proxy Host</fielddescr>
			<fieldname>parentproxy</fieldname>
			<description>Specify the parent proxy hostname or ip</description>
			<type>input</type>
		</field>		
		<field>
			<fielddescr>Parent Proxy Port</fielddescr>
			<fieldname>parentport</fieldname>
			<description>Specify the parent proxy port</description>
			<type>input</type>
		</field>		
		<field>
			<fielddescr>Max size of temporary files on disk</fielddescr>
			<fieldname>maxscansize</fieldname>
			<description>Temporary file will grow only up to this size. This means scanner will scan data until this limit is reached. The value is in BYTES, not kb or mb. 0 is Unlimited.</description>
			<type>input</type>
			<default_value>0</default_value>
		</field>		
		<field>
			<fielddescr>Trickling Time</fielddescr>
			<fieldname>trickling</fieldname>
			<description>After Trickling Time (seconds), some bytes are sent to browser to keep the connection alive. Trickling is not needed if timeouts are not expected. Default is 5 seconds. </description>
			<type>input</type>
			<default_value>5</default_value>
		</field>		
		<field>
			<fielddescr>Absolute Maximum Download Size</fielddescr>
			<fieldname>maxdownloadsize</fieldname>
			<description>Downloads larger than this will be blocked, Unless whitelisted. 0 is unlimited.</description>
			<type>input</type>
			<default_value>0</default_value>
		</field>		
	</fields>

	<custom_php_install_command> havp_install_command(); </custom_php_install_command>
	<custom_php_deinstall_command> havp_deinstall_command(); </custom_php_deinstall_command>
	<custom_php_resync_config_command> sync_package_havp(); </custom_php_resync_config_command>

</packagegui>

